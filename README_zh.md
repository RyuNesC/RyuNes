# RyuNes

### 介绍

大家好，请叫我 Ryu，这是我完全独立开发的 Nes 模拟器。

编写这个模拟器主要是出自个人爱好，从开始到完成初版都是独立完成。包括学习 Nes 硬件，编程和调试等。

代码的核心部分是由C完成的，虽然我的文件后缀用的是hpp和cpp。

我的模拟器有如下几个优势：

1. 代码更精简干净，整个模拟器的内核部分全部集中在 Nes 文件夹中，由干净的 C 语言代码组成，调用的也是 C Library，没有任何其它依赖。
2. 内核的 CPU 模拟，PPU 和 APU 部分都提供了单个周期级别的 API 调用，非常适合嵌入到任何平台。
3. 整份内核代码用纯 C 打造，可移植性很强。

所谓完全独立开发，是指内核部分（Nes）代码全部自己开发，没有使用任何第三方库。包括游戏的核心：CPU 指令集、PPU 图形处理单元和 APU 声音处理单元，以及 Nes 特有的 mapper 机制。

目前模拟器的内核已经可以支持了大部分游戏，可以正常玩耍很多经典游戏。

简单的包括大家耳熟能详的坦克大战、超级马里奥 1 代。更进阶的包括忍者神龟 1 到 3 代（以及格斗版本），还有塞尔达传说、重装机兵、勇者斗恶龙和最终幻想等均已支持。

当然了，还有很多环节还没完善，例如：

1. 关于 mapper，只支持几个相对主流的 mapper，如 0~4，74 。其它 mapper 还没有支持（不过这些问题应该不会很大）。比较困难的是 mapper 5，在支持中，但遇到了一些问题（bug）。
2. 游戏的 PPU 部分（即图形处理单元）的模拟，还有一些小的功能没有实现，但是这些功能大部分游戏都不会使用，例如没有实现 Emphasize Color 和 边缘裁剪（Crop）。
3. 因为调试不够充分，或许存在一些恶性 bug 我还没发现（虽然我试玩了一些游戏没有问题）
4. 没有想到的其它等等。

## 前端部分

因为我主要的开发工作集中在模拟器的核心部分（即后端），因此前端部分投入的时间不太多。在开源的代码中，我提供演示的是基于 Mac 的 SDL 版本的前端实现。

因此，想尝试运行本项目的爱好者需要有一台 Mac，并自行安装 SDL 和 XCode 才行。

我尝试过为我的 Nes 内核实现了几个前端，例如基于 OpenGL 的 Mac 程序，iOS 客户端 Demo 等，均运行良好。


## 如何运行

因为目前开源的仅是代码和基础前端 demo，因此现在的版本并不是正式 release 版。开源发布仅仅是宣告项目的诞生：）

运行本项目需要 MacOS 操作系统，开发环境是 XCode，开发者还需要自行下载 SDL 的运行时库。即可打开工程完成编译。

由于运行游戏需要 FC（nes）游戏 rom，因此开发者需要自行下载一个 rom （这不难办到），将它下载到本地的 Download 文件夹，并修改 NesWrap2.m 文件内的 runEmulatorLoop 方法中的 fileString 变量，将其改为本地文件的绝对路径即可。

## 后续的工作

后面的工作重心应该是先为 Nes 内核支持更多的 mapper 为主。前端开发部分不是最紧要的。

**不知道是否有愿意协助我开发 mapper 5 的小伙伴，我目前支持过程遇到了 bug -。- 。**

## 运行示例

以下是 SDL 前端运行的 Dragon Fighter：

![Dragon Fighter](https://github.com/RyuNesC/RyuNes/blob/main/ryu-nes/DemoAssets/demo001.png)

# 联系我

对项目感兴趣的可以联系我，这是我邮箱 roof456@qq.com 。

如果你能帮我支持 mapper 5，我愿意为你支付 100 美元：）

你也可以加我微信交流。

![My Wechat](https://github.com/RyuNesC/RyuNes/blob/main/ryu-nes/DemoAssets/wechat.jpg)
